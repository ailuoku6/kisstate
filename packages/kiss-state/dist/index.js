import{jsx as t}from"react/jsx-runtime";import n,{forwardRef as r,useMemo as e,useEffect as o,useState as u,useCallback as c}from"react";var a=function(){return a=Object.assign||function(t){for(var n,r=1,e=arguments.length;r<e;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},a.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var f=new WeakMap,i=new WeakMap,l={curCallBack:null},p=function(t){(i.get(t)||[]).forEach((function(t){return t()})),i.delete(t)},s=function(t,n){var r=l.curCallBack;l.curCallBack=n;var e=null,o=null;try{e=t()}catch(t){o=t,p(n)}finally{l.curCallBack=r}if(o)throw o;return e},v=function(t){(f.get(t)||[]).forEach((function(t){return t()}))},h=function(t,n){((null==t?void 0:t.keys())||[]).filter((function(r){var e;return null===(e=t.get(r))||void 0===e?void 0:e.has(n)})).forEach((function(t){return null==t?void 0:t()}))},y=function(t,n){var r=f.get(t)||[];r.push(n),f.set(t,r)};function d(t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var e=new(t.bind.apply(t,function(t,n,r){if(r||2===arguments.length)for(var e,o=0,u=n.length;o<u;o++)!e&&o in n||(e||(e=Array.prototype.slice.call(n,0,o)),e[o]=n[o]);return t.concat(e||Array.prototype.slice.call(n))}([void 0],n,!1))),o=new Map;e.__callbackMap__=o;var u=new Proxy(e,{set:function(t,n,r){var e=Reflect.get(t,n),c=Reflect.set(t,n,r);return e!==r&&(v(u),h(o,n)),c},get:function(t,n,r){var e,u,c,a=l.curCallBack;if(a){var f=o.get(a)||new Set;f.add(n),o.set(a,f),e=a,u=function(){o.delete(a)},(c=i.get(e)||[]).push(u),i.set(e,c)}return Reflect.get(t,n,r)}}),c=t.prototype.__watchFns__||[],a=u;return c.forEach((function(t){var n=[];y(u,(function(){setTimeout((function(){var r,e=t.deps.map((function(t){return a[t]})),o=e.some((function(t,r){return t!==n[r]}));n=e,o&&(null===(r=a[t.methodName])||void 0===r||r.call(a))}),0)}))})),v(u),u};return(n.prototype=Object.create(t.prototype)).constructor=n,Object.assign(n,t),n}function g(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(n,r,e){if("function"!=typeof e.value)throw new Error("@WatchProps can only decorate methods");var o=n.__watchFns__||[];o.push({methodName:r,deps:t}),n.__watchFns__=o}}function _(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(n,r,e){if("function"!=typeof e.get)throw new Error("@computed can only decorate methods");var o=e.get,u=!0,c=null,a=!0,f=[];e.get=function(){var n;return a&&(a=!1,y(n=this,(function(){var e=t.map((function(t){return n[t]})),a=e.some((function(t,n){return t!==f[n]}));f=e,a&&(u=!0,c=o.call(n),u=!1,v(n),h(n.__callbackMap__,r))}))),u?(c=o.call(this),u=!1,c):c}}}function m(f){var i,l=function(t){return Object.prototype.isPrototypeOf.call(n.Component,t)||Object.prototype.isPrototypeOf.call(n.PureComponent,t)}(f),v=(i=f).$$typeof&&"Symbol(react.forward_ref)"===i.$$typeof.toString(),h=function(n,r){var i,h=(i=u(0)[1],c((function(){i((function(t){return t+1}))}),[])),y=e((function(){if(!l)return v?function(n,r){var e=f,o=e.render;return e.render=function(t,n){return s((function(){return o(t,n)}),h)},t(e,a({},n,{ref:r}))}:function(t){return s((function(){return f(t)}),h)};var n=f,r=n.prototype,e=r.render;return r.render=function(){return s(e.bind(this),h)},function(r){return t(n,a({},r))}}),[f,l,v,h]);o((function(){return function(){p(h)}}),[h]);var d=null,g=null;try{d=y(n,r)}catch(t){g=t}if(g)throw g;return d};return l||!v?h:r(h)}export{d as ObservableClass,_ as computed,m as observer,g as watchProps};
