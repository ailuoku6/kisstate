import{jsx as e}from"react/jsx-runtime";import n,{forwardRef as t,useMemo as r,useState as o,useCallback as u,useRef as a,useEffect as i,useDebugValue as c}from"react";var f=new WeakMap,l=new WeakMap,s=[],p={curTrackObj:null},h=function(e){(l.get(e)||[]).forEach((function(e){return e()})),l.delete(e)},d=function(e,n){var t=p.curTrackObj;p.curTrackObj=n;var r=null,o=null;try{r=e()}catch(e){o=e,h(n)}finally{p.curTrackObj=t}if(o)throw o;return r},v=new(function(){function e(){var e=this;Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"hasNextConsumer",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"supportMessageChannel",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"channel",{enumerable:!0,configurable:!0,writable:!0,value:null}),this.supportMessageChannel="undefined"!=typeof MessageChannel,this.supportMessageChannel&&(this.channel=new MessageChannel,this.channel.port1.onmessage=function(){e.run()})}return Object.defineProperty(e.prototype,"add",{enumerable:!1,configurable:!0,writable:!0,value:function(e,n){void 0===n&&(n={});var t=n.immediate;this.queue.push(e),t?this.run():this.startTask()}}),Object.defineProperty(e.prototype,"startTask",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;this.hasNextConsumer||(this.hasNextConsumer=!0,this.supportMessageChannel&&this.channel?this.channel.port2.postMessage(null):setTimeout((function(){e.run()}),0))}}),Object.defineProperty(e.prototype,"run",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e,n=new Set,t=this.queue;for(this.queue=[],this.hasNextConsumer=!1;t.length;){var r=t.shift();r&&!n.has(r)&&(null===(e=r.fn)||void 0===e||e.call(r),n.add(r))}}}),e}()),b=function(e,n,t){if(t||2===arguments.length)for(var r,o=0,u=n.length;o<u;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))},y=function(e){(f.get(e)||[]).forEach((function(e){return v.add(e)}))},g=function(e,n){var t=f.get(e)||[];t.push(n),f.set(e,t)},m=function(e,n){var t=Array.from((null==e?void 0:e.keys())||[]).filter((function(t){var r;return null===(r=e.get(t))||void 0===r?void 0:r.has(n)}));t.filter((function(e){return e.fn})).forEach((function(e){return v.add(e)})),t.filter((function(e){return!e.fn})).forEach((function(e){return h(e)}))};function _(e){var n=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r=new(e.bind.apply(e,b([void 0],n,!1))),o=new Map;r.__trackObjMap__=o;var u=new Proxy(r,{set:function(e,n,t){var r=Reflect.get(e,n),a=Reflect.set(e,n,t);return r!==t&&(y(u),m(o,n)),a},get:function(e,n,t){var r,u,a,i=p.curTrackObj;if(i){var c=o.get(i)||new Set;c.add(n),o.set(i,c),r=i,u=function(){o.delete(i)},(a=l.get(r)||[]).push(u),l.set(r,a)}return Reflect.get(e,n,t)}}),a=e.prototype.__watchFns__||[];e.prototype.__getDebugValue__=function(e){var n=this.__trackObjMap__.get(e);return(null==n?void 0:n.size)?this:void 0};var i=u;return a.forEach((function(e){var n=[],t="w-".concat(e.methodName);g(u,{fn:function(){v.add({fn:function(){var t,r=e.deps.map((function(e){return i[e]})),o=r.some((function(e,t){return e!==n[t]}));n=r,o&&(null===(t=i[e.methodName])||void 0===t||t.call(i))},id:"w-".concat(e.methodName)})},id:t})})),y(u),s.push(r),u};return(n.prototype=Object.create(e.prototype)).constructor=n,Object.assign(n,e),n}function w(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return function(n,t,r){if("function"!=typeof r.value)throw new Error("@WatchProps can only decorate methods");var o=n.__watchFns__||[];o.push({methodName:t,deps:e}),n.__watchFns__=o}}function O(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return function(n,t,r){if("function"!=typeof r.get)throw new Error("@computed can only decorate methods");var o=r.get,u=!0,a=null,i=!0,c=[];r.get=function(){var n,r;return i&&(i=!1,n=this,r="c-".concat(t),g(n,{fn:function(){var r=e.map((function(e){return n[e]})),i=r.some((function(e,n){return e!==c[n]}));c=r,i&&(u=!0,a=o.call(n),u=!1,y(n),m(n.__trackObjMap__,t))},id:r})),u?(a=o.call(this),u=!1,a):a}}}var j=function(){return j=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},j.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var k=0,M=function(e){c(e,(function(e){return function(e){var n={},t=0;return s.forEach((function(r){var o,u=r.__getDebugValue__(e);u&&Object.assign(n,((o={})[t++]=u,o))})),n}(e)}))},P=function(){return null};function C(c){var f,l=function(e){return Object.prototype.isPrototypeOf.call(n.Component,e)||Object.prototype.isPrototypeOf.call(n.PureComponent,e)}(c),s=(f=c).$$typeof&&"Symbol(react.forward_ref)"===f.$$typeof.toString(),p=c.displayName||c.name,h=s?c.render:P,v=l?c.prototype.render:P,b=function(n,t){var f,p,b,y=(f=o(0)[1],u((function(){f((function(e){return e+1}))}),[])),g=(b=a({fn:p=y,id:"R-".concat(k++)}),i((function(){return b.current.fn=p,function(){b.current.fn=null}}),[p]),M(b.current),b.current),m=r((function(){if(!l)return s?function(n,t){var r=c;return r.render=function(e,n){return d((function(){return h(e,n)}),g)},e(r,j({},n,{ref:t}))}:function(e){return d((function(){return c(e)}),g)};var n=c,t=(n||{}).prototype;return(void 0===t?{}:t).render=function(){return d(v.bind(this),g)},function(t){return e(n,j({},t))}}),[c,l,s,g]);return m(n,t)},y=l||!s?b:t(b);return p&&(y.displayName=p),y}export{_ as ObservableClass,O as computed,C as observer,w as watchProps};
