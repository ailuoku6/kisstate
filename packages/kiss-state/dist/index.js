import{jsx as n}from"react/jsx-runtime";import r,{forwardRef as t,useState as e,useEffect as o,useMemo as c,useCallback as u}from"react";var a=function(){return a=Object.assign||function(n){for(var r,t=1,e=arguments.length;t<e;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o]);return n},a.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var f=new WeakMap,i=new WeakMap,l={curCallBack:null},p=function(n){(i.get(n)||[]).forEach((function(n){return n()})),i.delete(n)},s=function(n,r){var t=l.curCallBack;l.curCallBack=r;var e=null,o=null;try{e=n()}catch(n){o=n,p(r)}finally{l.curCallBack=t}if(o)throw o;return e},v=function(n){(f.get(n)||[]).forEach((function(n){return n()}))},d=function(n,r){((null==n?void 0:n.keys())||[]).filter((function(t){var e;return null===(e=n.get(t))||void 0===e?void 0:e.has(r)})).forEach((function(n){return null==n?void 0:n()}))},y=function(n,r){var t=f.get(n)||[];t.push(r),f.set(n,t)};function h(n){var r=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=new(n.bind.apply(n,function(n,r,t){if(t||2===arguments.length)for(var e,o=0,c=r.length;o<c;o++)!e&&o in r||(e||(e=Array.prototype.slice.call(r,0,o)),e[o]=r[o]);return n.concat(e||Array.prototype.slice.call(r))}([void 0],r,!1))),o=new Map;e.__callbackMap__=o;var c=new Proxy(e,{set:function(n,r,t){var e=Reflect.get(n,r),u=Reflect.set(n,r,t);return e!==t&&(v(c),d(o,r)),u},get:function(n,r,t){var e,c,u,a=l.curCallBack;if(a){var f=o.get(a)||new Set;f.add(r),o.set(a,f),e=a,c=function(){o.delete(a)},(u=i.get(e)||[]).push(c),i.set(e,u)}return Reflect.get(n,r,t)}}),u=n.prototype.__watchFns__||[],a=c;return u.forEach((function(n){var r=[];y(c,(function(){setTimeout((function(){var t,e=n.deps.map((function(n){return a[n]})),o=e.some((function(n,t){return n!==r[t]}));r=e,o&&(null===(t=a[n.methodName])||void 0===t||t.call(a))}),0)}))})),v(c),c};return(r.prototype=Object.create(n.prototype)).constructor=r,Object.assign(r,n),r}function g(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return function(r,t,e){if("function"!=typeof e.value)throw new Error("@WatchProps can only decorate methods");var o=r.__watchFns__||[];o.push({methodName:t,deps:n}),r.__watchFns__=o}}function m(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return function(r,t,e){if("function"!=typeof e.get)throw new Error("@computed can only decorate methods");var o=e.get,c=!0,u=null,a=!0,f=[];e.get=function(){var r;return a&&(a=!1,y(r=this,(function(){var e=n.map((function(n){return r[n]})),a=e.some((function(n,r){return n!==f[r]}));f=e,a&&(c=!0,u=o.call(r),c=!1,v(r),d(r.__callbackMap__,t))}))),c?(u=o.call(this),c=!1,u):u}}}var _=function(){return null};function w(f){var i,l=function(n){return Object.prototype.isPrototypeOf.call(r.Component,n)||Object.prototype.isPrototypeOf.call(r.PureComponent,n)}(f),v=(i=f).$$typeof&&"Symbol(react.forward_ref)"===i.$$typeof.toString(),d=f.displayName||f.name,y=v?f.render:_,h=l?f.prototype.render:_,g=function(r,t){var i,g=(i=e(0)[1],u((function(){i((function(n){return n+1}))}),[])),m=e(!1);m[0];var _=m[1];o((function(){return _(!0),function(){_(!1),p(g)}}),[g]);var w=c((function(){if(!l)return v?function(r,t){var e=f;return e.render=function(n,r){return console.log("fgylog forward render",d),s((function(){return y(n,r)}),g)},n(e,a({},r,{ref:t}))}:function(n){return console.log("fgylog function render",d),s((function(){return f(n)}),g)};var r=f,t=(r||{}).prototype;return(void 0===t?{}:t).render=function(){return console.log("fgylog class render",d),s(h.bind(this),g)},function(t){return n(r,a({},t))}}),[f,l,v,g]);return w(r,t)},m=l||!v?g:t(g);return d&&(m.displayName=d),m}export{h as ObservableClass,m as computed,w as observer,g as watchProps};
