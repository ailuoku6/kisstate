import{jsx as t}from"react/jsx-runtime";import{useEffect as r,useState as n,useCallback as e}from"react";var o=new WeakMap,u=function(){return u=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var o in r=arguments[n])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t},u.apply(this,arguments)};function c(t){var r=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var e=new(t.bind.apply(t,function(t,r,n){if(n||2===arguments.length)for(var e,o=0,u=r.length;o<u;o++)!e&&o in r||(e||(e=Array.prototype.slice.call(r,0,o)),e[o]=r[o]);return t.concat(e||Array.prototype.slice.call(r))}([void 0],r,!1))),u=new Proxy(e,{set:function(t,r,n){var e=Reflect.set(t,r,n);return(o.get(u)||[]).forEach((function(t){return t()})),e}}),c=t.prototype.__watchFns||[],f=u;return c.forEach((function(t){var r=[],n=o.get(u)||[];n.push((function(){var n,e=t.deps.map((function(t){return f[t]})),o=e.some((function(t,n){return t!==r[n]}));r=e,o&&(null===(n=f[t.methodName])||void 0===n||n.call(f))})),o.set(u,n)})),(o.get(u)||[]).forEach((function(t){return t()})),u};return(r.prototype=Object.create(t.prototype)).constructor=r,Object.assign(r,t),r}function f(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return function(r,n,e){if("function"!=typeof e.value)throw new Error("@WatchProps 只能装饰方法");var o=r.__watchFns||[];o.push({methodName:n,deps:t}),r.__watchFns=o}}function a(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return function(r,n,e){if("function"!=typeof e.get)throw new Error("@computed 只能装饰方法");var u=e.get,c=!0,f=null,a=!0,i=[];e.get=function(){var r,n;return a&&(a=!1,r=this,(n=o.get(r)||[]).push((function(){var n=t.map((function(t){return r[t]})),e=n.some((function(t,r){return t!==i[r]}));i=n,e&&(c=!0)})),o.set(r,n)),c?(f=u.call(this),c=!1,f):f}}}"function"==typeof SuppressedError&&SuppressedError;var i=function(c){for(var f=[],a=1;a<arguments.length;a++)f[a-1]=arguments[a];return function(a){var i,p=(i=n(0)[1],e((function(){i((function(t){return t+1}))}),[]));return r((function(){return f.forEach((function(t){var r=o.get(t)||[];r.push(p),o.set(t,r)})),function(){f.forEach((function(t){var r=(o.get(t)||[]).filter((function(t){return t!==p}));o.set(t,r)}))}}),[p]),t(c,u({},a))}};export{c as ObservableClass,a as computed,i as observer,o as renderEffctWeakMap,f as watchProps};
