import{jsx as t}from"react/jsx-runtime";import n,{forwardRef as r,useState as e,useEffect as o,useMemo as c,useCallback as u}from"react";var a=function(){return a=Object.assign||function(t){for(var n,r=1,e=arguments.length;r<e;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},a.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var i=new WeakMap,f=new WeakMap,l={curCallBack:null},p=function(t){(f.get(t)||[]).forEach((function(t){return t()})),f.delete(t)},s=function(t,n){var r=l.curCallBack;l.curCallBack=n;var e=null,o=null;try{e=t()}catch(t){o=t,p(n)}finally{l.curCallBack=r}if(o)throw o;return e},v=function(t){(i.get(t)||[]).forEach((function(t){return t()}))},h=function(t,n){((null==t?void 0:t.keys())||[]).filter((function(r){var e;return null===(e=t.get(r))||void 0===e?void 0:e.has(n)})).forEach((function(t){return null==t?void 0:t()}))},d=function(t,n){var r=i.get(t)||[];r.push(n),i.set(t,r)};function y(t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var e=new(t.bind.apply(t,function(t,n,r){if(r||2===arguments.length)for(var e,o=0,c=n.length;o<c;o++)!e&&o in n||(e||(e=Array.prototype.slice.call(n,0,o)),e[o]=n[o]);return t.concat(e||Array.prototype.slice.call(n))}([void 0],n,!1))),o=new Map;e.__callbackMap__=o;var c=new Proxy(e,{set:function(t,n,r){var e=Reflect.get(t,n),u=Reflect.set(t,n,r);return e!==r&&(v(c),h(o,n)),u},get:function(t,n,r){var e,c,u,a=l.curCallBack;if(a){var i=o.get(a)||new Set;i.add(n),o.set(a,i),e=a,c=function(){o.delete(a)},(u=f.get(e)||[]).push(c),f.set(e,u)}return Reflect.get(t,n,r)}}),u=t.prototype.__watchFns__||[],a=c;return u.forEach((function(t){var n=[];d(c,(function(){setTimeout((function(){var r,e=t.deps.map((function(t){return a[t]})),o=e.some((function(t,r){return t!==n[r]}));n=e,o&&(null===(r=a[t.methodName])||void 0===r||r.call(a))}),0)}))})),v(c),c};return(n.prototype=Object.create(t.prototype)).constructor=n,Object.assign(n,t),n}function g(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(n,r,e){if("function"!=typeof e.value)throw new Error("@WatchProps can only decorate methods");var o=n.__watchFns__||[];o.push({methodName:r,deps:t}),n.__watchFns__=o}}function m(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(n,r,e){if("function"!=typeof e.get)throw new Error("@computed can only decorate methods");var o=e.get,c=!0,u=null,a=!0,i=[];e.get=function(){var n;return a&&(a=!1,d(n=this,(function(){var e=t.map((function(t){return n[t]})),a=e.some((function(t,n){return t!==i[n]}));i=e,a&&(c=!0,u=o.call(n),c=!1,v(n),h(n.__callbackMap__,r))}))),c?(u=o.call(this),c=!1,u):u}}}function _(i){var f,l=function(t){return Object.prototype.isPrototypeOf.call(n.Component,t)||Object.prototype.isPrototypeOf.call(n.PureComponent,t)}(i),v=(f=i).$$typeof&&"Symbol(react.forward_ref)"===f.$$typeof.toString(),h=i.displayName||i.name,d=function(n,r){var f,d=(f=e(0)[1],u((function(){f((function(t){return t+1}))}),[])),y=e(!1);y[0];var g=y[1];o((function(){return g(!0),function(){g(!1),p(d)}}),[d]);var m=c((function(){if(!l)return v?function(n,r){var e=i,o=e.render;return e.render=function(t,n){return s((function(){return o(t,n)}),d)},t(e,a({},n,{ref:r}))}:function(t){return s((function(){return i(t)}),d)};var n=i,r=(n||{}).prototype,e=void 0===r?{}:r,o=e.render;return e.render=function(){return console.log("fgylog class render",h),s(o.bind(this),d)},function(r){return t(n,a({},r))}}),[i,l,v,d]),_=null,w=null;try{_=m(n,r)}catch(t){w=t}if(w)throw w;return _},y=l||!v?d:r(d);return y.displayName=h,y}export{y as ObservableClass,m as computed,_ as observer,g as watchProps};
